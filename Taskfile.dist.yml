# Ensure you have task installed:
# https://taskfile.dev

version: '3'

vars:
  GREETING: Task is running!

tasks:
  # Default task for now (soon will be a build + test...)
  default:
    cmds:
      - echo "{{.GREETING}}"
    silent: true

  # Clean the project's artifact
  clean:
    cmds:
      - rm -vrf dist
      - rm -vrf build

  build-app:
    cmds:
      - bun run build

  # Build the platform
  build:
    deps: [build-app]
    cmds:
      - docker build -t passage .

  # Standard test commands
  test:
    cmds:
      - bun run test

  test-coverage:
    cmds:
      - bun run test-coverage

  test-watch:
    cmds:
      - bun run test-watch

  server:
    cmds:
      - bun run express

  server-dev:
    cmds:
      - bun run express-dev

  launch:
    cmds:
      - docker-compose up

  teardown:
    cmds:
      - docker-compose down

  # Future dev tool
#  dx-import-idea:
#    prompt: "This will overwrite existing JetBrains configs, are you sure?"
#    cmds:
#      - echo "Not implemented yet"

